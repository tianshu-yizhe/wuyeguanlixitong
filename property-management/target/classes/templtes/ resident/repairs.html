<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>物业管理系统 - 报修服务</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <style>
    /* 共用样式省略，与resident-dashboard.html相同 */
    .repair-card {
      border-left: 4px solid;
      transition: all 0.3s;
    }
    .repair-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    .status-pending {
      border-left-color: #ffc107;
    }
    .status-processing {
      border-left-color: #17a2b8;
    }
    .status-completed {
      border-left-color: #28a745;
    }
    .repair-image {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
      cursor: pointer;
    }
    .repair-image:hover {
      opacity: 0.8;
    }
    .problem-type {
      display: inline-block;
      padding: 3px 8px;
      background-color: #f8f9fa;
      border-radius: 4px;
      font-size: 0.8rem;
    }
  </style>
</head>
<body>
<!-- 侧边栏省略，与resident-dashboard.html相同 -->
<div class="main-content">
  <nav class="navbar navbar-expand-lg navbar-custom mb-4">
    <!-- 导航栏省略，与resident-dashboard.html相同 -->
  </nav>

  <div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h4><i class="bi bi-tools me-2"></i> 报修服务</h4>
      <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newRepairModal">
        <i class="bi bi-plus-circle me-1"></i> 发起报修
      </button>
    </div>

    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card card-custom">
          <div class="card-header">
            <div class="row">
              <div class="col-md-6">
                <div class="btn-group">
                  <button class="btn btn-outline-secondary active">全部</button>
                  <button class="btn btn-outline-secondary">处理中</button>
                  <button class="btn btn-outline-secondary">已完成</button>
                </div>
              </div>
              <div class="col-md-6">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="搜索报修记录...">
                  <button class="btn btn-outline-secondary" type="button">
                    <i class="bi bi-search"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 mb-4">
                <div class="card repair-card status-processing h-100">
                  <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                      <div>
                        <h5 class="card-title">水管漏水</h5>
                        <span class="problem-type">水管问题</span>
                      </div>
                      <span class="badge bg-info">处理中</span>
                    </div>
                    <p class="card-text">卫生间水管接口处漏水严重，已经影响到日常使用。</p>
                    <div class="d-flex mb-3">
                      <img src="https://via.placeholder.com/150" alt="报修图片" class="repair-image me-2">
                      <img src="https://via.placeholder.com/150" alt="报修图片" class="repair-image">
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                      <small class="text-muted">报修日期: 2023-11-14</small>
                      <button class="btn btn-sm btn-outline-primary">查看详情</button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 mb-4">
                <div class="card repair-card status-completed h-100">
                  <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                      <div>
                        <h5 class="card-title">空调故障</h5>
                        <span class="problem-type">电器问题</span>
                      </div>
                      <span class="badge bg-success">已完成</span>
                    </div>
                    <p class="card-text">卧室空调无法制冷，遥控器显示正常但空调不工作。</p>
                    <div class="d-flex mb-3">
                      <img src="https://via.placeholder.com/150" alt="报修图片" class="repair-image">
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                      <small class="text-muted">报修日期: 2023-11-10</small>
                      <button class="btn btn-sm btn-outline-primary">查看详情</button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 mb-4">
                <div class="card repair-card status-completed h-100">
                  <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                      <div>
                        <h5 class="card-title">门锁损坏</h5>
                        <span class="problem-type">门锁问题</span>
                      </div>
                      <span class="badge bg-success">已完成</span>
                    </div>
                    <p class="card-text">入户门锁转动困难，有时钥匙无法拔出。</p>
                    <div class="d-flex mb-3">
                      <img src="https://via.placeholder.com/150" alt="报修图片" class="repair-image me-2">
                      <img src="https://via.placeholder.com/150" alt="报修图片" class="repair-image">
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                      <small class="text-muted">报修日期: 2023-11-05</small>
                      <button class="btn btn-sm btn-outline-primary">查看详情</button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 mb-4">
                <div class="card repair-card status-completed h-100">
                  <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                      <div>
                        <h5 class="card-title">电路跳闸</h5>
                        <span class="problem-type">电路问题</span>
                      </div>
                      <span class="badge bg-success">已完成</span>
                    </div>
                    <p class="card-text">厨房电路频繁跳闸，无法正常使用电器。</p>
                    <div class="d-flex mb-3">
                      <img src="https://via.placeholder.com/150" alt="报修图片" class="repair-image">
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                      <small class="text-muted">报修日期: 2023-10-28</small>
                      <button class="btn btn-sm btn-outline-primary">查看详情</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <nav aria-label="Page navigation" class="mt-4">
              <ul class="pagination justify-content-center">
                <li class="page-item disabled">
                  <a class="page-link" href="#" tabindex="-1" aria-disabled="true">上一页</a>
                </li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item">
                  <a class="page-link" href="#">下一页</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 发起报修模态框 -->
<div class="modal fade" id="newRepairModal" tabindex="-1" aria-labelledby="newRepairModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="newRepairModalLabel">发起新报修</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="repairType" class="form-label">问题类型</label>
              <select class="form-select" id="repairType" required>
                <option value="">请选择问题类型</option>
                <option value="water">水管问题</option>
                <option value="electric">电路问题</option>
                <option value="door">门锁问题</option>
                <option value="appliance">电器问题</option>
                <option value="elevator">电梯问题</option>
                <option value="other">其他问题</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="repairLocation" class="form-label">问题位置</label>
              <select class="form-select" id="repairLocation" required>
                <option value="">请选择问题位置</option>
                <option value="living-room">客厅</option>
                <option value="bedroom">卧室</option>
                <option value="kitchen">厨房</option>
                <option value="bathroom">卫生间</option>
                <option value="balcony">阳台</option>
                <option value="public-area">公共区域</option>
              </select>
            </div>
          </div>
          <div class="mb-3">
            <label for="repairTitle" class="form-label">问题标题</label>
            <input type="text" class="form-control" id="repairTitle" placeholder="简要描述问题" required>
          </div>
          <div class="mb-3">
            <label for="repairDescription" class="form-label">详细描述</label>
            <textarea class="form-control" id="repairDescription" rows="4" placeholder="请详细描述您遇到的问题..." required></textarea>
          </div>
          <div class="mb-3">
            <label for="repairImages" class="form-label">上传图片</label>
            <input type="file" class="form-control" id="repairImages" multiple accept="image/*">
            <small class="text-muted">最多可上传5张图片，每张不超过5MB</small>
            <div id="imagePreview" class="mt-2 d-flex flex-wrap gap-2"></div>
          </div>
          <div class="mb-3">
            <label for="repairContact" class="form-label">联系电话</label>
            <input type="tel" class="form-control" id="repairContact" value="138****1234" required>
          </div>
          <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="urgentRepair">
            <label class="form-check-label" for="urgentRepair">紧急报修 (24小时内处理)</label>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary">提交报修</button>
      </div>
    </div>
  </div>
</div>

<!-- 图片预览模态框 -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body text-center">
        <img src="" id="modalImage" class="img-fluid">
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  document.getElementById('sidebarToggle').addEventListener('click', function() {
    document.querySelector('.sidebar').classList.toggle('active');
  });

  // 图片预览功能
  const repairImages = document.getElementById('repairImages');
  const imagePreview = document.getElementById('imagePreview');
  const modalImage = document.getElementById('modalImage');
  const imageModal = new bootstrap.Modal(document.getElementById('imageModal'));

  repairImages.addEventListener('change', function() {
    imagePreview.innerHTML = '';
    const files = this.files;

    for(let i = 0; i < Math.min(files.length, 5); i++) {
      const file = files[i];
      if(!file.type.match('image.*')) continue;

      const reader = new FileReader();
      reader.onload = function(e) {
        const img = document.createElement('img');
        img.src = e.target.result;
        img.classList.add('repair-image');
        img.style.width = '80px';
        img.style.height = '80px';
        img.style.cursor = 'pointer';
        img.addEventListener('click', function() {
          modalImage.src = this.src;
          imageModal.show();
        });
        imagePreview.appendChild(img);
      }
      reader.readAsDataURL(file);
    }
  });

  // 点击报修图片查看大图
  document.querySelectorAll('.repair-image').forEach(img => {
    img.addEventListener('click', function() {
      modalImage.src = this.src;
      imageModal.show();
    });
  });
</script>
</body>
</html>